<html>

<head>
  <title>Todo App</title>
</head>

<body>
  <form id="form">
    <input type="text" name="title" id="title" />
    <input type="submit" value="Create" />
  </form>
  <h1>Todos</h1>
  <ul id="todos">
    {% for d in data %}
    <li>{{ d.title }}</li>
    {% endfor %}
  </ul>

  <script>
    document.getElementById('form').onsubmit = (e) => {
      e.preventDefault();
      fetch('/todos/create', {
        method: 'POST',
        body: JSON.stringify({
          'title': document.getElementById('title').value || ""
        }),
        headers: {
          'Content-Type': 'application/json'
        }
      })
        .then(resp => resp.json())
        .then(resp => {
          console.log(resp);
          const todo = document.createElement('li');
          todo.innerHTML = resp.title;
          document.getElementById('todos').appendChild(todo);
        }
        )
    }
  </script>
</body>

</html>